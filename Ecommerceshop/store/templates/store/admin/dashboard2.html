{% extends 'store/admin/dashboard.html' %}
{% load static %}
{% load humanize %}
{% block asd %}


<div class="app-main__outer">
      <div class="app-main__inner">
            <!-- <div class="app-page-title">
                  <div class="page-title-wrapper">
                        <div class="page-title-heading">
                              <div class="page-title-icon">
                                    <i class="pe-7s-car icon-gradient bg-mean-fruit">
                                    </i>
                              </div>
                              <div>Analytics Dashboard
                                    <div class="page-title-subheading">This is an
                                          example
                                          dashboard created using
                                          build-in elements and components.
                                    </div>
                              </div>
                        </div>
                        <div class="page-title-actions">
                              <button type="button" data-toggle="tooltip" title="Example Tooltip"
                                    data-placement="bottom" class="btn-shadow mr-3 btn btn-dark">
                                    <i class="fa fa-star"></i>
                              </button>
                              <div class="d-inline-block dropdown">
                                    <button type="button" data-toggle="dropdown" aria-haspopup="true"
                                          aria-expanded="false" class="btn-shadow dropdown-toggle btn btn-info">
                                          <span class="btn-icon-wrapper pr-2 opacity-7">
                                                <i class="fa fa-business-time fa-w-20"></i>
                                          </span>
                                          Buttons
                                    </button>
                                    <div tabindex="-1" role="menu" aria-hidden="true"
                                          class="dropdown-menu dropdown-menu-right">
                                          <ul class="nav flex-column">
                                                <li class="nav-item">
                                                      <a href="javascript:void(0);" class="nav-link">
                                                            <i class="nav-link-icon lnr-inbox"></i>
                                                            <span>
                                                                  Inbox
                                                            </span>
                                                            <div class="ml-auto badge badge-pill badge-secondary">
                                                                  86
                                                            </div>
                                                      </a>
                                                </li>
                                                <li class="nav-item">
                                                      <a href="javascript:void(0);" class="nav-link">
                                                            <i class="nav-link-icon lnr-book"></i>
                                                            <span>
                                                                  Book
                                                            </span>
                                                            <div class="ml-auto badge badge-pill badge-danger">
                                                                  5
                                                            </div>
                                                      </a>
                                                </li>
                                                <li class="nav-item">
                                                      <a href="javascript:void(0);" class="nav-link">
                                                            <i class="nav-link-icon lnr-picture"></i>
                                                            <span>
                                                                  Picture
                                                            </span>
                                                      </a>
                                                </li>
                                                <li class="nav-item">
                                                      <a disabled href="javascript:void(0);" class="nav-link disabled">
                                                            <i class="nav-link-icon lnr-file-empty"></i>
                                                            <span>
                                                                  File
                                                                  Disabled
                                                            </span>
                                                      </a>
                                                </li>
                                          </ul>
                                    </div>
                              </div>
                        </div>
                  </div> 
            </div> -->
            <div class="row">
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content bg-midnight-bloom">
                              <div class="widget-content-wrapper text-white">
                                    <div class="widget-content-left">
                                          <div class="widget-heading">
                                                ยอดขายทั้งหมด</div>

                                    </div>
                                    <div class="widget-content-right">

                                          <div class="widget-numbers text-white">
                                                <span>{{payload.total|intcomma}}
                                                      บาท</span>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content bg-arielle-smile">
                              <div class="widget-content-wrapper text-white">
                                    <div class="widget-content-left">
                                          <div class="widget-heading">จำนวน Order
                                                ทั้งหมด
                                          </div>
                                    </div>
                                    <div class="widget-content-right">
                                          <div class="widget-numbers text-white">
                                                <span>{{payload.order_count}}</span>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content bg-grow-early">
                              <div class="widget-content-wrapper text-white">
                                    <div class="widget-content-left">
                                          <div class="widget-heading">
                                                จำนวนสินค้าทั้งหมด
                                          </div>

                                    </div>
                                    <div class="widget-content-right">
                                          <div class="widget-numbers text-white">
                                                <span>{{payload.products}}</span>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <!-- <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content bg-premium-dark">
                              <div class="widget-content-wrapper text-white">
                                    <div class="widget-content-left">
                                          <div class="widget-heading">Products
                                                Sold</div>
                                          <div class="widget-subheading">Revenue
                                                streams
                                          </div>
                                    </div>
                                    <div class="widget-content-right">
                                          <div class="widget-numbers text-warning">
                                                <span>$14M</span>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div> -->
            </div>

            <!-- <div class="row">
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content">
                              <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                          <div class="widget-content-left">
                                                <div class="widget-heading">
                                                      Total Orders
                                                </div>
                                                <div class="widget-subheading">
                                                      Last year
                                                      expenses</div>
                                          </div>
                                          <div class="widget-content-right">
                                                <div class="widget-numbers text-success">
                                                      1896</div>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content">
                              <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                          <div class="widget-content-left">
                                                <div class="widget-heading">
                                                      Products
                                                      Sold</div>
                                                <div class="widget-subheading">
                                                      Revenue
                                                      streams</div>
                                          </div>
                                          <div class="widget-content-right">
                                                <div class="widget-numbers text-warning">
                                                      $3M</div>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content">
                              <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                          <div class="widget-content-left">
                                                <div class="widget-heading">
                                                      Followers
                                                </div>
                                                <div class="widget-subheading">
                                                      People
                                                      Interested</div>
                                          </div>
                                          <div class="widget-content-right">
                                                <div class="widget-numbers text-danger">
                                                      45,9%</div>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
                  <div class="d-xl-none d-lg-block col-md-6 col-xl-4">
                        <div class="card mb-3 widget-content">
                              <div class="widget-content-outer">
                                    <div class="widget-content-wrapper">
                                          <div class="widget-content-left">
                                                <div class="widget-heading">
                                                      Income</div>
                                                <div class="widget-subheading">
                                                      Expected
                                                      totals</div>
                                          </div>
                                          <div class="widget-content-right">
                                                <div class="widget-numbers text-focus">
                                                      $147</div>
                                          </div>
                                    </div>
                                    <div class="widget-progress-wrapper">
                                          <div class="progress-bar-sm progress-bar-animated-alt progress">
                                                <div class="progress-bar bg-info" role="progressbar" aria-valuenow="54"
                                                      aria-valuemin="0" aria-valuemax="100" style="width: 54%;">
                                                </div>
                                          </div>
                                          <div class="progress-sub-label">
                                                <div class="sub-label-left">
                                                      Expenses
                                                </div>
                                                <div class="sub-label-right">
                                                      100%</div>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
            </div> -->
            <div class="row">
                  <div class="col-md-12">
                        <div class="main-card mb-3 card">
                              <div class="card-header">รายการการสั่งซื้อทั้งหมด
                                    <!-- <div class="btn-actions-pane-right">
                                          <div role="group" class="btn-group-sm btn-group">
                                                <button class="active btn btn-focus">Last
                                                      Week</button>
                                                <button class="btn btn-focus">All
                                                      Month</button>
                                          </div>
                                    </div> -->
                              </div>
                              <div class="table-responsive">
                                    <table class="align-middle mb-0 table table-borderless table-striped table-hover">
                                          <thead>
                                                <tr>
                                                      <th class="text-center">วันสั่งซื้อสินค้า</th>
                                                      <th class="">ชื่อ</th>
                                                      <th class="text-center">รหัสใบสั่งซื้อ</th>
                                                      <th class="text-center">ยอดรวม</th>
                                                      <th class="text-center">วิธีการชำระ</th>
                                                      <th class="text-center">สถานะ</th>
                                                      <th class="text-center">Tracking No.</th>

                                                </tr>
                                          </thead>
                                          <tbody>

                                                {% for order in payload.orders %}

                                                <tr>
                                                      <td class="text-center text-muted">
                                                            {{order.created}}
                                                      </td>
                                                      <td class="text-center">
                                                            <div class="widget-content p-0">
                                                                  <div class="widget-content-wrapper">


                                                                        <div class="widget-content-left">
                                                                              คุณ
                                                                              {{order.user.first_name}}
                                                                        </div>




                                                                  </div>
                                                            </div>
                                                      </td>
                                                      <td class="text-center">
                                                            <a href="{% url 'updatetracking' order.order_id %}">
                                                                  <var class="price">{{order.order_id}}</var>
                                                            </a>
                                                      </td>
                                                      <td class="text-center">
                                                            <div class="badge badge-warning">
                                                                  {{order.total_all|intcomma}}
                                                                  บาท
                                                            </div>
                                                      </td>
                                                      <td class="text-center">
                                                            {% if order.paymenttype_id == 1 %}
                                                            <p>-</p>


                                                            {% elif order.paymenttype_id == 2 or 3 %}

                                                            {% if order.transfer_image %}
                                                            <a href="{{ order.transfer_image.url }}"
                                                                  target="_blank">ดูสลิป</a>
                                                            / โอนผ่าน {{ order.bank.bank_name }}

                                                            {% elif not order.transfer_image %}
                                                            <span class="fas fa-window-close"
                                                                  style='font-size:24px;color:red'></span>

                                                            {% endif %}

                                                            {% endif %}
                                                      </td>


                                                      {% if order.orderstatus_id == 1 %}


                                                      <td class="text-center">
                                                            <span class="fas fa-window-close"
                                                                  style='font-size:24px;color:red'></span>
                                                      </td>


                                                      {% elif order.orderstatus_id == 2 %}
                                                      {% if order.transfer_image or order.paymenttype_id == 1 %}
                                                      <td class="text-center">
                                                            <a href="{% url 'status_change' order.order_id %}"><i
                                                                        class="fa fa-plus-square"
                                                                        aria-hidden="true"></i>
                                                                  ยืนยันการสั่ง</a>
                                                      </td>
                                                      {% else %}
                                                      <td class="text-center">
                                                            <span class="fas fa-window-close"
                                                                  style='font-size:24px;color:red'></span>
                                                      </td>
                                                      {% endif %}
                                                      {% else %}
                                                      <td class="text-center">

                                                            <span class="fas fa-check-square"
                                                                  style='font-size:24px;color:green'></span>

                                                      </td>
                                                      {% endif %}

                                                      <td class="text-center">
                                                            {% if order.transfer == None %}
                                                            <span class="text-center">-</span>
                                                            {% else %}
                                                            <p class="text-center">{{order.transfer}}</p>
                                                            {% endif %}
                                                      </td>





                                                </tr>

                                                {% endfor %}
                                          </tbody>
                                    </table>
                              </div>
                              <!-- <div class="d-block text-center card-footer">
                                    <button class="mr-2 btn-icon btn-icon-only btn btn-outline-danger"><i
                                                class="pe-7s-trash btn-icon-wrapper">
                                          </i></button>
                                    <button class="btn-wide btn btn-success">Save</button>
                              </div> -->
                        </div>
                  </div>
            </div>

      </div>

</div>
<script src="http://maps.google.com/maps/api/js?sensor=true"></script>
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.4.0/dist/chartjs-plugin-datalabels.js"></script>
<script language="JavaScript">


      var labels = [];
      "{% for order in payload.order_item %}"
      labels.push("{{ order.product }}");
      "{% endfor %}"

      var data = [];
      "{% for order in payload.order_item %}"
      data.push("{{ order.sum_all }}");
      "{% endfor %}"


      let ctx = document.getElementById("chart").getContext("2d");

      let chart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                  labels: labels,
                  datasets: [{
                        label: '# of Votes',
                        data: data,
                        // Set this value to undefined
                        backgroundColor: [
                              '#f87979',
                              '#79f879',
                              '#7979f8'
                        ],
                        borderWidth: 5
                  }]
            },
            options: {
                  tooltips: {
                        mode: null
                  },
                  plugins: {
                        datalabels: {
                              borderWidth: 5,
                              borderColor: "white",
                              borderRadius: 8,
                              // color: 0,
                              font: {
                                    weight: "bold"
                              },
                              backgroundColor: "lightgray"
                        }
                  }
            }
      });


      let ctx2 = document.getElementById("chart2").getContext("2d");

      let chart2 = new Chart(ctx2, {
            type: 'bar',
            data: {
                  labels: labels,
                  datasets: [{
                        label: '# of Votes',
                        data: data,
                        // Set this value to undefined
                        backgroundColor: [
                              '#f87979',
                              '#79f879',
                              '#7979f8'
                        ],
                        borderWidth: 5
                  }]
            },
            options: {
                  tooltips: {
                        mode: null
                  },
                  plugins: {
                        datalabels: {
                              borderWidth: 5,
                              borderColor: "white",
                              borderRadius: 8,
                              // color: 0,
                              font: {
                                    weight: "bold"
                              },
                              backgroundColor: "lightgray"
                        }
                  }
            }
      });
</script>

{% endblock %}